<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Import - My Schedule</title>
  <style>
    /* â•â•â•â•â•â•â• RESET â•â•â•â•â•â•â• */
    body {
      margin:0; padding:0;
      background:#eef1f7;
      font-family:'Segoe UI', system-ui, -apple-system, BlinkMacSystemFont, Roboto, Helvetica, Arial, sans-serif;
      color:#0f172a;
      -webkit-font-smoothing:antialiased;
    }
    * { box-sizing:border-box; }

    /* â•â•â•â•â•â•â• WRAP â•â•â•â•â•â•â• */
    .wrap { max-width:680px; margin:0 auto; padding:16px 14px 28px; }

    /* â•â•â•â•â•â•â• HEADER â•â•â•â•â•â•â• */
    .header {
      background:linear-gradient(135deg, #1e40af 0%, #1976d2 50%, #0ea5e9 100%);
      color:#fff;
      padding:26px 18px 24px;
      border-radius:20px;
      text-align:center;
      box-shadow:0 8px 28px rgba(30,64,175,.25);
      position:relative;
      overflow:hidden;
    }
    .header::before {
      content:''; position:absolute;
      top:-30px; right:-40px;
      width:140px; height:140px;
      border-radius:50%;
      background:rgba(255,255,255,.08);
    }
    .header::after {
      content:''; position:absolute;
      bottom:-50px; left:-30px;
      width:160px; height:160px;
      border-radius:50%;
      background:rgba(255,255,255,.06);
    }
    .header h1 { margin:0; font-size:24px; font-weight:800; position:relative; z-index:1; letter-spacing:-.3px; }

    /* Ø²Ø± Ø§Ù„Ù„ØºØ© */
    .langToggle {
      position:absolute; top:14px; right:16px; z-index:10;
      background:rgba(255,255,255,.18); border:2px solid rgba(255,255,255,.25);
      border-radius:50%; width:32px; height:32px;
      display:flex; align-items:center; justify-content:center;
      color:#fff; font-size:13px; font-weight:800; cursor:pointer;
      transition:all .25s; -webkit-tap-highlight-color:transparent; padding:0;
    }
    .langToggle:hover { background:rgba(255,255,255,.30); transform:scale(1.08); }
    body.ar { direction:rtl; font-family:'Segoe UI',Tahoma,Arial,sans-serif; }
    .empRow, .empName, .empStatus { direction:ltr !important; unicode-bidi:embed; text-align:left !important; }

    /* Ø±Ø³Ø§Ù„Ø© Ø§Ù„ØªØ±Ø­ÙŠØ¨ */
    .welcomeMsg {
      position:absolute; top:14px; left:16px; z-index:10;
      background:rgba(255,255,255,.18); border:1px solid rgba(255,255,255,.25);
      border-radius:20px; padding:4px 10px;
      color:#fff; font-size:11px; font-weight:700;
      display:none; align-items:center; gap:5px;
      max-width:160px; overflow:hidden; text-overflow:ellipsis; white-space:nowrap;
      cursor:pointer; transition:all .25s;
    }
    .welcomeMsg:hover { background:rgba(255,255,255,.28); }
    .welcomeMsg.visible { display:flex; }

    /* Date Picker Wrapper */
    .datePickerWrapper {
      position:relative;
      display:inline-block;
      margin-top:14px;
      z-index:1;
    }
    .header .dateTag {
      display:inline-block;
      background:rgba(255,255,255,.18);
      padding:5px 18px;
      border-radius:10px;
      font-size:13px;
      font-weight:600;
      letter-spacing:.3px;
      cursor:pointer;
      transition:all .3s;
      border:2px solid rgba(255,255,255,.2);
      -webkit-tap-highlight-color:transparent;
      user-select:none;
      -webkit-user-select:none;
      direction:ltr;
    }
    .header .dateTag:hover {
      background:rgba(255,255,255,.25);
      transform:translateY(-1px);
    }
    /* Ø§Ù„Ù€ input Ù…Ø®ÙÙŠ ØªÙ…Ø§Ù…Ø§Ù‹ - Ù„Ø§ ÙŠÙØ±Ù‰ ÙˆÙ„Ø§ ÙŠÙØ¶ØºØ· Ø¹Ù„ÙŠÙ‡ */
#datePicker {
  position: absolute;
  top: 100%;
  left: 50%;
  transform: translateX(-50%);
  width: 1px;
  height: 1px;
  opacity: 0;
  pointer-events: none;
  font-size: 16px;   /* Ù…Ù‡Ù… Ø¬Ø¯Ø§Ù‹ Ù„Ù…Ù†Ø¹ zoom Ø¹Ù„Ù‰ iOS */
  border: none;
  /* â† Ø£Ø¶Ù Ù‡Ø°Ø§: */
  -webkit-appearance: none;
}


    /* â•â•â•â•â•â•â• SUMMARY BAR â•â•â•â•â•â•â• */
    .summaryBar { 
      display:flex; 
      justify-content:center; 
      align-items:stretch;
      gap:12px; 
      margin-top:14px;
      flex-wrap:wrap;
    }
    a.summaryChip:hover {
      transform:translateY(-3px);
      box-shadow:0 8px 20px rgba(15,23,42,.12);
    }
    a.summaryChip.gamesChip .chipVal { color:#7c3aed; }
    a.summaryChip.gamesChip:hover { box-shadow:0 8px 20px rgba(124,58,237,.18); }
    .summaryChip {
      background:#fff;
      border:1px solid rgba(15,23,42,.1);
      border-radius:14px;
      padding:10px 12px;
      text-align:center;
      box-shadow:0 2px 8px rgba(15,23,42,.06);
      transition:all .25s ease;
      min-width:72px;
    }
    .summaryChip .chipVal { font-size:22px; font-weight:900; color:#1e40af; }
    .summaryChip .chipLabel { 
      font-size:9.5px;
      font-weight:600; 
      color:#64748b; 
      text-transform:uppercase; 
      letter-spacing:.4px; 
      margin-top:2px;
      white-space:nowrap;
    }

    /* â•â•â•â•â•â•â• SHIFT FILTER BUTTONS AS CHIPS â•â•â•â•â•â•â• */
    button.summaryChip.shiftFilterBtn {
      border:2px solid transparent;
      position:relative;
      overflow:hidden;
      padding:10px 14px; /* padding Ø£ØµØºØ± Ù„Ù„Ø£Ø²Ø±Ø§Ø± */
    }
    button.summaryChip.shiftFilterBtn:hover {
      transform:translateY(-3px);
      box-shadow:0 8px 20px rgba(15,23,42,.12);
    }
    button.summaryChip.shiftFilterBtn.active {
      border-color:currentColor;
      box-shadow:0 6px 16px rgba(15,23,42,.18);
    }
    button.summaryChip.shiftFilterBtn.active::before {
      content:'';
      position:absolute;
      top:0;left:0;right:0;bottom:0;
      background:currentColor;
      opacity:.06;
    }
    
    /* Ø£Ù„ÙˆØ§Ù† Ø§Ù„ÙˆØ±Ø¯ÙŠØ§Øª */
    button.shiftFilterBtn.morning {
      color:#f59e0b;
    }
    button.shiftFilterBtn.morning .chipVal { color:#f59e0b; }
    button.shiftFilterBtn.morning .chipLabel { color:#92400e; }
    
    button.shiftFilterBtn.afternoon {
      color:#f97316;
    }
    button.shiftFilterBtn.afternoon .chipVal { color:#f97316; }
    button.shiftFilterBtn.afternoon .chipLabel { color:#9a3412; }
    
    button.shiftFilterBtn.night {
      color:#8b5cf6;
    }
    button.shiftFilterBtn.night .chipVal { color:#8b5cf6; }
    button.shiftFilterBtn.night .chipLabel { color:#5b21b6; }
    
    button.shiftFilterBtn.all {
      color:#1e40af;
    }
    button.shiftFilterBtn.all .chipVal { color:#1e40af; }
    button.shiftFilterBtn.all .chipLabel { color:#1e40af; }
    
    /* Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„Ù…ØªÙˆØ³Ø·Ø© */
    @media (max-width:900px){
      .summaryBar { flex-wrap:wrap; } /* Ø§Ù„Ø³Ù…Ø§Ø­ Ø¨Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ù„ØµÙ Ø§Ù„Ø«Ø§Ù†ÙŠ */
    }
    
    /* Ù„Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ */
    @media (max-width:600px){
      .summaryBar { gap:6px; }
      .summaryChip { padding:8px 8px; min-width:60px; }
      .summaryChip .chipVal { font-size:18px; }
      .summaryChip .chipLabel { font-size:8.5px; letter-spacing:.2px; }
    }


    /* â•â•â•â•â•â•â• DEPARTMENT CARD â•â•â•â•â•â•â• */
    .deptCard {
      margin-top:18px;
      background:#fff;
      border-radius:18px;
      overflow:hidden;
      border:1px solid rgba(15,23,42,.07);
      box-shadow:0 4px 18px rgba(15,23,42,.08);
    }
    .deptHead {
      display:flex;
      align-items:center;
      gap:12px;
      padding:14px 16px;
      background:#fff;
    }
    .deptIcon {
      width:40px; height:40px;
      border-radius:12px;
      display:flex; align-items:center; justify-content:center;
      flex-shrink:0;
    }
    .deptTitle { font-size:18px; font-weight:800; color:#1e293b; flex:1; letter-spacing:-.2px; }
    .deptBadge { min-width:48px; padding:6px 10px; border-radius:12px; text-align:center; }

    /* â•â•â•â•â•â•â• SHIFT STACK â•â•â•â•â•â•â• */
    .shiftStack { padding:10px; display:flex; flex-direction:column; gap:8px; }

    /* â•â•â•â•â•â•â• SHIFT CARD â€” <details> â•â•â•â•â•â•â• */
    .shiftCard {
      border-radius:14px;
      overflow:hidden;
    }

    .shiftSummary {
      display:flex;
      align-items:center;
      gap:10px;
      padding:11px 14px;
      cursor:pointer;
      list-style:none;
      -webkit-appearance:none;
      appearance:none;
      user-select:none;
    }
    .shiftSummary::-webkit-details-marker { display:none; }
    .shiftSummary::marker              { display:none; }

    .shiftIcon  { font-size:20px; line-height:1; flex-shrink:0; }
    .shiftLabel { font-size:15px; font-weight:800; flex:1; letter-spacing:-.1px; }
    .shiftCount {
      font-size:13px; font-weight:800;
      padding:3px 10px; border-radius:20px;
      flex-shrink:0;
    }

    /* chevron ÙŠØ¯ÙˆØ± Ù„Ù…Ø§ ÙŠÙØªØ­ */
    .shiftSummary::after {
      content:'â–¾';
      font-size:14px;
      color:#94a3b8;
      transition:transform .2s;
      flex-shrink:0;
    }
    .shiftCard[open] .shiftSummary::after {
      transform:rotate(180deg);
    }

    .shiftBody { background:rgba(255,255,255,.7); }

    /* â”€â”€ employee row â”€â”€ */
    .empRow {
      display:flex;
      align-items:center;
      justify-content:space-between;
      padding:9px 16px;
      border-top:1px solid rgba(15,23,42,.06);
    }
    .empRowAlt { background:rgba(15,23,42,.02); }
    .empName  { font-size:15px; font-weight:700; color:#1e293b; }
    .empStatus { font-size:13px; font-weight:600; }

    /* â•â•â•â•â•â•â• CTA â•â•â•â•â•â•â• */
    .btnWrap { margin-top:20px; text-align:center; }
    .btn {
      display:inline-block;
      padding:14px 38px;
      border-radius:16px;
      background:linear-gradient(135deg, #1e40af, #1976d2);
      color:#fff !important;
      text-decoration:none;
      font-weight:800;
      font-size:15px;
      box-shadow:0 6px 20px rgba(30,64,175,.3);
    }

    /* â•â•â•â•â•â•â• FOOTER â•â•â•â•â•â•â• */
    .footer { margin-top:18px; text-align:center; font-size:12px; color:#94a3b8; padding:12px 0; line-height:1.9; }
    .footer strong { color:#64748b; }

    /* â•â•â•â•â•â•â• MOBILE â•â•â•â•â•â•â• */
    @media (max-width:480px){
      .wrap            { padding:12px 10px 22px; }
      .header h1       { font-size:21px; }
      .deptTitle       { font-size:16px; }
      .empName         { font-size:14px; }
      .empStatus       { font-size:12px; }
      .shiftLabel      { font-size:14px; }
      .summaryBar      { gap:8px; }
      .summaryChip     { padding:8px 14px; }
      .summaryChip .chipVal { font-size:19px; }
    }

  
  .card{background:#fff;border-radius:18px;border:1px solid rgba(15,23,42,.07);box-shadow:0 4px 18px rgba(15,23,42,.08);padding:14px;margin-top:16px}
  .row{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
  input{padding:12px 14px;border-radius:14px;border:1px solid rgba(15,23,42,.15);font-size:16px;background:rgba(255,255,255,.75)}
  button{padding:12px 16px;border-radius:14px;border:0;font-weight:800;cursor:pointer;background:linear-gradient(135deg,#1e40af,#1976d2);color:#fff}
  table{width:100%;border-collapse:separate;border-spacing:0 8px}
  td,th{text-align:center;padding:10px 8px;background:rgba(15,23,42,.03)}
  th{font-size:12px;color:#64748b}
  .pill{display:inline-block;padding:4px 10px;border-radius:999px;font-weight:800}
  </style>
</head>
<body>
<div class="wrap">
  <div class="header">
    <button class="langToggle" onclick="location.href=_importBase()+'/'">âŸµ</button>
    <h1 id="pageTitle">ğŸ—“ï¸ Import - My Schedule</h1>
    <div class="datePickerWrapper">
      <div class="dateTag" style="cursor:default">Search by ID</div>
    </div>
  </div>

  <div class="card">
    <div class="row">
      <div style="font-weight:900;">ID</div>
      <input id="empId" inputmode="numeric" placeholder="e.g. 990896" />
      <button onclick="loadSchedule()">View</button>
    </div>
    <div style="margin-top:10px;color:#64748b;font-size:12px">
      Tip: Your ID is saved automatically after viewing.
    </div>
  </div>

  <div class="card" id="result" style="display:none"></div>
</div>

<script>
function _importBase() {
  var origin = location.origin;
  var root = (location.pathname.includes('/roster-site/') ? origin + '/roster-site' : origin);
  return root + '/import';
}

function badge(code) {
  var s=(code||"").toUpperCase().trim();
  if(s==="O"||s==="OFF") return '<span class="pill" style="background:#e0e7ff;color:#3730a3">OFF</span>';
  if(s.startsWith("MN")||s.startsWith("ME")) return '<span class="pill" style="background:#fef3c7;color:#92400e">'+code+'</span>';
  if(s.startsWith("AN")||s.startsWith("AE")) return '<span class="pill" style="background:#ffedd5;color:#9a3412">'+code+'</span>';
  if(s.startsWith("NN")||s.startsWith("NE")) return '<span class="pill" style="background:#ede9fe;color:#5b21b6">'+code+'</span>';
  return '<span class="pill" style="background:#f1f5f9;color:#334155">'+code+'</span>';
}

async function loadSchedule(idParam) {
  var id = idParam || document.getElementById('empId').value.trim();
  if(!id) return;
  localStorage.setItem('savedEmpId', id);

  var url = _importBase() + '/schedules/' + encodeURIComponent(id) + '.json';
  var res = await fetch(url);
  if(!res.ok) {
    document.getElementById('result').style.display='block';
    document.getElementById('result').innerHTML = '<div style="font-weight:900">Not found</div><div style="color:#64748b;margin-top:6px">No schedule JSON for ID '+id+'</div>';
    return;
  }
  var data = await res.json();

  var days = data.days || [];
  var rows = days.map(d => '<tr><td>'+d.day+'</td><td>'+d.weekday+'</td><td>'+badge(d.code)+'</td></tr>').join('');
  var html = `
    <div style="font-weight:900;font-size:18px">${data.name}</div>
    <div style="color:#64748b;font-weight:700;margin-top:2px">${data.department} Â· ${data.monthLabel}</div>
    <table style="margin-top:12px">
      <thead><tr><th>Day</th><th>Weekday</th><th>Shift</th></tr></thead>
      <tbody>${rows}</tbody>
    </table>
  `;

  var box = document.getElementById('result');
  box.style.display='block';
  box.innerHTML=html;
}

(function() {
  var params = new URLSearchParams(location.search);
  var emp = params.get('emp');
  var saved = localStorage.getItem('savedEmpId');
  if(emp) { document.getElementById('empId').value = emp; loadSchedule(emp); }
  else if(saved) { document.getElementById('empId').value = saved; }
})();
</script>
</body>
</html>
